---
# Clang-Tidy configuration for Polang
#
# Run with:
#   clang-tidy -p build <source-file>
#
# Or check all files:
#   clang-tidy -p build parser/src/*.cpp compiler/src/*.cpp repl/src/*.cpp mlir/lib/*/*.cpp

Checks: >
  -*,
  bugprone-*,
  performance-*,
  modernize-*,
  readability-*,
  -bugprone-easily-swappable-parameters,
  -modernize-use-trailing-return-type,
  -readability-identifier-length,
  -readability-function-cognitive-complexity,
  -readability-convert-member-functions-to-static,
  -performance-enum-size

# Only check project headers, not system/LLVM/MLIR headers or generated files
# Excludes build/ directory by requiring path to start with the component name
HeaderFilterRegex: '^.*/polang/(parser|compiler|repl|mlir)/(include|lib)/.*\\.hpp?$'

# Don't treat warnings as errors (use -warnings-as-errors= to override)
WarningsAsErrors: ''

CheckOptions:
  # Braces around statements
  - key: readability-braces-around-statements.ShortStatementLines
    value: '0'

  # Implicit bool conversion settings
  - key: readability-implicit-bool-conversion.AllowIntegerConditions
    value: false
  - key: readability-implicit-bool-conversion.AllowPointerConditions
    value: false

  # Modernize settings
  - key: modernize-use-override.IgnoreDestructors
    value: false
  - key: modernize-use-override.IgnoreTemplateInstantiations
    value: false

  # Performance settings
  - key: performance-unnecessary-value-param.IncludeStyle
    value: google

  # Avoid false positives for MLIR patterns
  - key: bugprone-unused-return-value.CheckedFunctions
    value: ''

  # Naming conventions - LLVM style (lowerCamelCase for functions/variables)
  # Types: CamelCase
  - key: readability-identifier-naming.ClassCase
    value: CamelCase
  - key: readability-identifier-naming.ClassIgnoredRegexp
    value: '^(raw_|llvm_|mlir_).*'
  - key: readability-identifier-naming.StructCase
    value: CamelCase
  - key: readability-identifier-naming.EnumCase
    value: CamelCase
  - key: readability-identifier-naming.EnumConstantCase
    value: CamelCase
  - key: readability-identifier-naming.TypeAliasCase
    value: CamelCase
  - key: readability-identifier-naming.TypeAliasIgnoredRegexp
    value: '^YY_.*'
  - key: readability-identifier-naming.TypedefCase
    value: CamelCase
  - key: readability-identifier-naming.TypedefIgnoredRegexp
    value: '^YY_.*'
  - key: readability-identifier-naming.TemplateParameterCase
    value: CamelCase
  # Functions/Methods: lowerCamelCase
  - key: readability-identifier-naming.FunctionCase
    value: camelBack
  - key: readability-identifier-naming.FunctionIgnoredRegexp
    value: '^(polang_|yy_).*'
  - key: readability-identifier-naming.MethodCase
    value: camelBack
  # Variables: lowerCamelCase
  - key: readability-identifier-naming.ParameterCase
    value: camelBack
  - key: readability-identifier-naming.LocalVariableCase
    value: camelBack
  - key: readability-identifier-naming.LocalConstantCase
    value: camelBack
  # Members: lowerCamelCase
  - key: readability-identifier-naming.MemberCase
    value: camelBack
  - key: readability-identifier-naming.PublicMemberCase
    value: camelBack
  - key: readability-identifier-naming.PrivateMemberCase
    value: camelBack
  - key: readability-identifier-naming.ProtectedMemberCase
    value: camelBack
  # Constants: UPPER_CASE for global/static, lowerCamelCase for local
  - key: readability-identifier-naming.GlobalConstantCase
    value: UPPER_CASE
  - key: readability-identifier-naming.StaticConstantCase
    value: UPPER_CASE
  - key: readability-identifier-naming.ConstexprVariableCase
    value: UPPER_CASE
  # Namespaces: lowercase
  - key: readability-identifier-naming.NamespaceCase
    value: lower_case

  # Magic numbers - ignore common values
  - key: readability-magic-numbers.IgnoredIntegerValues
    value: '0;1;2;-1'
  - key: readability-magic-numbers.IgnoredFloatingPointValues
    value: '0.0;1.0;-1.0'
  - key: readability-magic-numbers.IgnorePowersOf2IntegerValues
    value: true
  - key: readability-magic-numbers.IgnoreTypeAliases
    value: true
...
